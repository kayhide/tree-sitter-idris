================================================================================
Maybe 1
================================================================================

data Maybe a = Just a | Nothing

--------------------------------------------------------------------------------

(source_file
  (data
    (data_name)
    (untyped_binding
      (bid))
    (expr
      (atom
        (qid))
      (atom
        (qid))
      (atom
        (qid)))))

================================================================================
Maybe 2
================================================================================

list_lookup : Nat -> List a -> Maybe a
list_lookup _     Nil         = Nothing
list_lookup Z     (x :: xs) = Just x
list_lookup (S k) (x :: xs) = list_lookup k xs

--------------------------------------------------------------------------------

(source_file
  (function
    (lhs
      (function_name
        (atom
          (qid))))
    (rhs
      (expr
        (atom
          (qid))
        (expr
          (atom
            (qid))
          (atom
            (qid))
          (expr
            (atom
              (qid))
            (atom
              (qid)))))))
  (function
    (lhs
      (atom
        (qid))
      (atom)
      (atom
        (qid)))
    (rhs
      (expr
        (atom
          (qid)))))
  (function
    (lhs
      (atom
        (qid))
      (atom
        (qid))
      (atom
        (expr
          (atom
            (qid))
          (atom
            (qid))
          (atom
            (qid)))))
    (rhs
      (expr
        (atom
          (qid))
        (atom
          (qid)))))
  (function
    (lhs
      (atom
        (qid))
      (atom
        (expr
          (atom
            (qid))
          (atom
            (qid))))
      (atom
        (expr
          (atom
            (qid))
          (atom
            (qid))
          (atom
            (qid)))))
    (rhs
      (expr
        (atom
          (qid))
        (atom
          (qid))
        (atom
          (qid))))))

================================================================================
Maybe 3
================================================================================

maybe : Lazy b -> Lazy (a -> b) -> Maybe a -> b

--------------------------------------------------------------------------------

(source_file
  (function
    (lhs
      (function_name
        (atom
          (qid))))
    (rhs
      (expr
        (atom
          (qid))
        (atom
          (qid))
        (expr
          (atom
            (qid))
          (atom
            (expr
              (atom
                (qid))
              (expr
                (atom
                  (qid)))))
          (expr
            (atom
              (qid))
            (atom
              (qid))
            (expr
              (atom
                (qid)))))))))

================================================================================
Tuples 1
================================================================================

fred : (String, Int)
fred = ("Fred", 42)

--------------------------------------------------------------------------------

(source_file
  (function
    (lhs
      (function_name
        (atom
          (qid))))
    (rhs
      (expr
        (atom
          (expr
            (atom
              (qid))
            (atom
              (qid)))))))
  (function
    (lhs
      (atom
        (qid)))
    (rhs
      (expr
        (atom
          (expr
            (atom
              (literal))
            (atom
              (qid))
            (atom
              (qid))))))))

================================================================================
Tuples 2
================================================================================

jim : (String, Int, String)
jim = ("Jim", 25, "Cambridge")

--------------------------------------------------------------------------------

(source_file
  (function
    (lhs
      (function_name
        (atom
          (qid))))
    (rhs
      (expr
        (atom
          (expr
            (atom
              (qid))
            (atom
              (qid))
            (atom
              (qid)))))))
  (function
    (lhs
      (atom
        (qid)))
    (rhs
      (expr
        (atom
          (expr
            (atom
              (literal))))))))

================================================================================
Dependent Pairs 1
================================================================================

data DPair : (a : Type) -> (p : a -> Type) -> Type where
   MkDPair : {p : a -> Type} -> (x : a) -> p x -> DPair a p

--------------------------------------------------------------------------------

(source_file
  (data
    (data_name)
    (expr
      (typed_binding
        (atom
          (qid))
        (expr
          (atom
            (qid))))
      (expr
        (typed_binding
          (atom
            (qid))
          (expr
            (atom
              (qid))
            (expr
              (atom
                (qid)))))
        (expr
          (atom
            (qid)))))
    (function
      (lhs
        (function_name
          (atom
            (qid))))
      (rhs
        (expr
          (typed_binding
            (atom
              (qid))
            (expr
              (atom
                (qid))
              (expr
                (atom
                  (qid)))))
          (expr
            (typed_binding
              (atom
                (qid))
              (expr
                (atom
                  (qid))))
            (expr
              (atom
                (qid))
              (atom
                (qid))
              (expr
                (atom
                  (qid))
                (atom
                  (qid))
                (atom
                  (qid))))))))))

================================================================================
Dependent Pairs 2
================================================================================

vec : (n : Nat ** Vect n Int)
vec = (2 ** [3, 4])

--------------------------------------------------------------------------------

(source_file
  (function
    (lhs
      (function_name
        (atom
          (qid)))))
  (ERROR
    (typed_binding
      (atom
        (qid))
      (expr
        (atom
          (qid))
        (atom
          (qid))
        (atom
          (qid))
        (atom
          (qid))
        (atom
          (qid)))))
  (function
    (lhs
      (atom
        (qid)))
    (rhs
      (expr
        (atom
          (atom
            (qid))
          (atom
            (qid))
          (atom
            (qid)))))))

================================================================================
Dependent Pairs 3
================================================================================

filter : (a -> Bool) -> Vect n a -> (n' ** Vect n' a)
filter p Nil = (_ ** [])
filter p (x :: xs)
    = case filter p xs of
           (_ ** xs') => if p x then (_ ** x :: xs')
                                else (_ ** xs')

--------------------------------------------------------------------------------

(source_file
  (function
    (lhs
      (function_name
        (atom
          (qid))))
    (rhs
      (expr
        (atom
          (expr
            (atom
              (qid))
            (expr
              (atom
                (qid)))))
        (expr
          (atom
            (qid))
          (atom
            (qid))
          (atom
            (qid))
          (expr
            (atom
              (atom
                (qid))
              (atom
                (qid))
              (atom
                (qid))
              (atom
                (qid))))))))
  (function
    (lhs
      (atom
        (qid))
      (atom
        (qid))
      (atom
        (qid)))
    (rhs
      (expr
        (atom
          (atom)
          (atom
            (qid))))))
  (function
    (lhs
      (atom
        (qid))
      (atom
        (qid))
      (atom
        (expr
          (atom
            (qid))
          (atom
            (qid))
          (atom
            (qid)))))
    (rhs
      (expr
        (atom
          (qid))
        (atom
          (qid))
        (atom
          (qid))
        (atom
          (qid))
        (atom
          (qid))
        (atom
          (atom)
          (atom
            (qid)))
        (atom
          (qid))
        (atom
          (qid))
        (atom
          (qid))
        (atom
          (qid))
        (atom
          (qid))
        (atom
          (atom)
          (atom
            (qid))
          (atom
            (qid))
          (atom
            (qid)))
        (atom
          (qid))
        (atom
          (atom)
          (atom
            (qid)))))))

================================================================================
Records 1
================================================================================

record Person where
    constructor MkPerson
    firstName, middleName, lastName : String
    age : Int

--------------------------------------------------------------------------------

(source_file
  (record
    (record_name
      (qid))
    (record_declarations_block
      (record_constructor
        (id))
      (function
        (lhs
          (function_name
            (atom
              (qid))
            (atom
              (qid))
            (atom
              (qid))))
        (rhs
          (expr
            (atom
              (qid)))))
      (function
        (lhs
          (function_name
            (atom
              (qid))))
        (rhs
          (expr
            (atom
              (qid))))))))

================================================================================
Records 2
================================================================================

fred : Person
fred = MkPerson "Fred" "Joe" "Bloggs" 30

--------------------------------------------------------------------------------

(source_file
  (function
    (lhs
      (function_name
        (atom
          (qid))))
    (rhs
      (expr
        (atom
          (qid)))))
  (function
    (lhs
      (atom
        (qid)))
    (rhs
      (expr
        (atom
          (qid))
        (atom
          (literal))
        (atom
          (qid))))))

================================================================================
Records 3
================================================================================

record Class where
    constructor ClassInfo
    students : Vect n Person
    className : String

--------------------------------------------------------------------------------

(source_file
  (record
    (record_name
      (qid))
    (record_declarations_block
      (record_constructor
        (id))
      (function
        (lhs
          (function_name
            (atom
              (qid))))
        (rhs
          (expr
            (atom
              (qid))
            (atom
              (qid))
            (atom
              (qid)))))
      (function
        (lhs
          (function_name
            (atom
              (qid))))
        (rhs
          (expr
            (atom
              (qid))))))))

================================================================================
Records 4
================================================================================

addStudent : Person -> Class -> Class
addStudent p c = { students := p :: students c } c

--------------------------------------------------------------------------------

(source_file
  (function
    (lhs
      (function_name
        (atom
          (qid))))
    (rhs
      (expr
        (atom
          (qid))
        (expr
          (atom
            (qid))
          (expr
            (atom
              (qid)))))))
  (function
    (lhs
      (atom
        (qid))
      (atom
        (qid))
      (atom
        (qid)))
    (rhs
      (expr
        (atom
          (expr
            (atom
              (qid))
            (atom
              (qid))
            (atom
              (qid))
            (atom
              (qid))
            (atom
              (qid))
            (atom
              (qid))))
        (atom
          (qid))))))

================================================================================
Records 5
================================================================================

addStudent' : Person -> Class -> Class
addStudent' p c = { students $= (p ::) } c

--------------------------------------------------------------------------------

(source_file
  (function
    (lhs
      (function_name
        (atom
          (qid))))
    (rhs
      (expr
        (atom
          (qid))
        (expr
          (atom
            (qid))
          (expr
            (atom
              (qid)))))))
  (function
    (lhs
      (atom
        (qid))
      (atom
        (qid))
      (atom
        (qid)))
    (rhs
      (expr
        (atom
          (expr
            (atom
              (qid))
            (atom
              (qid))
            (atom
              (expr
                (atom
                  (qid))
                (atom
                  (qid))))))
        (atom
          (qid))))))
